{% extends "withnav_template.html" %}
{% from "components/radios.html" import radio, conditional_radio_panel %}
{% from "components/select-input.html" import select_wrapper %}
{% from "components/textbox.html" import textbox %}
{% from "components/page-header.html" import page_header %}
{% from "components/page-footer.html" import page_footer %}
{% from "components/form.html" import form_wrapper %}
{% from "components/radios/macro.njk" import govukRadios %}

{% block service_page_title %}
  Change {{ branding_type }} branding
{% endblock %}

{% block maincolumn_content %}

  {{ page_header(
    'Change {} branding'.format(branding_type),
    back_link=url_for('.view_template', service_id=current_service.id, template_id=from_template) if from_template else url_for('.service_settings', service_id=current_service.id)
  ) }}

  <p class="govuk-body">
    Your {{ branding_type }}s currently have {{ branding_name }} branding.
  </p>

  {% if current_service.needs_to_change_email_branding and branding_type == "email" %}
    <p class="govuk-body">
      You should be using your own branding instead. We can help you to set this up.
    </p>
  {% endif %}

  {% call form_wrapper() %}
    {% if form.something_else_is_only_option %}
      {{ textbox(
        form.something_else,
        hint='Include links to your brand guidelines or examples of how to use your branding',
        width='1-1',
      ) }}
    {% else %}
      {% set conditional %}
        {{ textbox(
          form.something_else,
          hint='Include links to your brand guidelines or examples of how to use your branding',
          width='1-1',
          autosize=True,
        ) }}
      {% endset %}
      {% set items = wtforms_option_fields_to_govuk_items(form.options) %}
      {% for item in items %}
        {% if item["value"] == form.FALLBACK_OPTION_VALUE %}
          {% set _ = item.update({ "conditional": { "html": conditional } }) %}
        {% endif %}
      {% endfor %}
      {{ govukRadios({
        "name": form.options.name,
        "attributes": { "data-module": "radios" },
        "fieldset": {
          "legend": {
            "text": form.options.label.text,
            "classes": "govuk-visually-hidden"
          }
        },
        "errorMessage": {
          "text": form.options.errors[0]
        } if form.options.errors else False,
        "items": items
      }) }}
    {% endif %}
    <p class="form-group">
      We’ll email you once your branding’s ready to use, or if we need any
      more information.
    </p>
    {{ page_footer('Request new branding') }}
  {% endcall %}

{% endblock %}
