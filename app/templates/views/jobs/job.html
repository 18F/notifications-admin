{% extends "withnav_template.html" %}
{% from "components/banner.html" import banner %}
{% from "components/sms-message.html" import sms_message %}
{% from "components/email-message.html" import email_message %}

{% block page_title %}
  {{ uploaded_file_name }} â€“ GOV.UK Notify
{% endblock %}

{% block maincolumn_content %}

    <h1 class="heading-large">
      {{ uploaded_file_name }}
    </h1>

    {% if 'sms' == template.template_type %}
      <div class="grid-row">
        <div class="column-two-thirds">
          {{ sms_message(
            template.formatted_as_markup,
          )}}
        </div>
      </div>
    {% elif 'email' == template.template_type %}
      {{ email_message(
        template.formatted_subject_as_markup,
        template.formatted_as_markup
      )}}
    {% endif %}

    <div
      {% if not finished %}
        data-module="update-content"
        data-resource="{{url_for(".view_job_updates", service_id=current_service.id, job_id=job.id, status=status, help=request.args.get('help', 0))}}"
        data-key="status"
        aria-live="polite"
      {% endif %}
    >
      {% include 'partials/jobs/status.html' %}
    </div>

    <div
      {% if not finished %}
        data-module="update-content"
        data-resource="{{url_for(".view_job_updates", service_id=current_service.id, job_id=job.id, status=status, help=request.args.get('help', 0))}}"
        data-key="counts"
        aria-live="polite"
      {% endif %}
    >
      {% include 'partials/jobs/count.html' %}
    </div>

    <div
      {% if notifications %}
        class='dashboard-table'
      {% endif %}
      {% if not finished %}
        data-module="update-content"
        data-resource="{{url_for(".view_job_updates", service_id=current_service.id, job_id=job.id, status=request.args.get('status'), help=request.args.get('help'))}}"
        data-key="notifications"
        aria-live="polite"
      {% endif %}
    >
      {% include 'partials/jobs/notifications.html' %}
    </div>

{% endblock %}
