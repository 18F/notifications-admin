{% extends "withnav_template.html" %}
<!-- {% from "components/banner.html" import banner_wrapper %} -->
<!-- {% from "components/table.html" import list_table, field, text_field, index_field, hidden_field_heading %} -->
<!-- {% from "components/file-upload.html" import file_upload %} -->
<!-- {% from "components/page-footer.html" import page_footer %} -->
{% from "components/radios.html" import radio_select %}
{% from "components/message-count-label.html" import message_count_label %}

{% block service_page_title %}
  {{ "Error" if errors else "Preview" }}
{% endblock %}

{% block maincolumn_content %}

  <h1 class="heading-large">
    Preview of {{ template.name }}
  </h1>

  {{ template|string }}

  <div class="bottom-gutter-3-2">
    <form method="post" enctype="multipart/form-data" action="{{url_for('main.send_notification', service_id=current_service.id, template_id=template.id)}}" class='page-footer'>
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
      <input type="hidden" name="help" value="{{ '3' if help else 0 }}" />
      {% if template.template_type != 'letter' or not request.args.from_test %}
      <input type="submit" class="button" value="Send 1 {{ message_count_label(1, template.template_type, suffix='') }}" />
      {% else %}
        <a href="{{ url_for('main.check_messages_preview', service_id=current_service.id, template_type=template.template_type, upload_id=upload_id, filetype='pdf') }}" download="download" class="button">Download as a printable PDF</a>
      {% endif %}
      <a href="{{ back_link }}" class="page-footer-back-link">Back</a>
    </form>
  </div>

{% endblock %}
