{% extends "withnav_template.html" %}
{% from "components/table.html" import list_table, field, right_aligned_field_heading %}
{% from "components/big-number.html" import big_number %}

{% block page_title %}
  {{ session.get('service_name', 'Dashboard') }} – GOV.UK Notify
{% endblock %}

{% block maincolumn_content %}

    <ul class="grid-row job-totals">
      <li class="column-half">
        {{ big_number(
          free_text_messages_remaining,
          'free text messages remaining'
        )}}
      </li>
      <li class="column-half">
        {{ big_number(
          '£' + spent_this_month,
          'spent this month'
        )}}
      </li>
    </ul>

    {% if not jobs %}
      {{ banner(
        'Send yourself a text message',
        subhead='Get started',
        type='tip'
      )}}
    {% else %}
      {% call(item) list_table(
        jobs,
        caption="Recent text messages",
        empty_message='You haven’t sent any text messages yet',
        field_headings=['Job', 'Created', right_aligned_field_heading('Status')]
      ) %}
        {% call field() %}
          <a href="{{ url_for('.view_job', service_id=service_id, job_id=item.id) }}">{{ item.original_file_name }}</a>
        {% endcall %}
        {% call field() %}
          {{ item.created_at|format_datetime }}
        {% endcall %}
        {% call field(align='right') %}
          {{ item.status }}
        {% endcall %}
      {% endcall %}
      {% if more_jobs_to_show %}
        <p class="table-show-more-link">
          <a href="{{ url_for('.view_jobs', service_id=service_id) }}">See all sent text messages</a>
        </p>
      {% endif %}
    {% endif %}

{% endblock %}
