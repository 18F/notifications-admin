{% extends "withnav_template.html" %}
{% from "components/page-header.html" import page_header %}
{% from "components/page-footer.html" import page_footer %}
{% from "components/textbox.html" import textbox %}
{% from "components/radios.html" import radios %}
{% from "components/banner.html" import banner_wrapper %}
{% from "components/form.html" import form_wrapper %}
{% from "components/radios/macro.njk" import govukRadios %}

{% block service_page_title %}
  Create an API key
{% endblock %}

{% block maincolumn_content %}

  {{ page_header(
    'Create an API key',
    back_link=url_for('main.api_keys', service_id=current_service.id)
  ) }}

  {% call form_wrapper() %}
    {{ textbox(form.key_name, label='Name for this key') }}
    {% set items = wtforms_option_fields_to_govuk_items(form.key_type) %}
    {% for item in items %}
      {% if item.value in option_hints.keys() %}
        {% set _ = item.update({ "hint": { "html": option_hints[item.value] } }) %}
      {% endif %}
      {% if item.value in disabled_options %}
        {% set _ = item.update({ "disabled": True }) %}
      {% endif %}
    {% endfor %}
    {{ govukRadios({
      "name": form.key_type.name,
      "fieldset": {
        "legend": {
          "text": form.key_type.label.text
        }
      },
      "errorMessage": {
        "text": form.key_type.errors[0]
      } if form.key_type.errors else False,
      "items": items
    }) }}
    {{ page_footer('Continue') }}
  {% endcall %}

{% endblock %}
